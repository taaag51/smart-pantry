# E2E テスト環境

このプロジェクトでは、Cypress を使用した E2E テストを実装しています。
テストは自動的に実行され、結果は GitHub Actions で確認できます。

## テスト実行環境

- Cypress: E2E テストフレームワーク
- GitHub Actions: CI/CD 環境
- スケジュール実行: 6 時間ごと
- ブラウザ: Chrome (Headless モード)

## テストシナリオ

### 認証機能のテスト (`cypress/integration/auth.spec.ts`)

1. ログインフロー

   - メールアドレス・パスワードの入力
   - ログインボタンのクリック
   - ログイン後の画面遷移確認

2. バリデーションチェック

   - 空入力時のボタン無効化
   - 部分入力時のボタン無効化

3. 新規登録フロー

   - 登録モードへの切り替え
   - ユーザー情報の入力
   - 登録処理の実行

4. エラーハンドリング
   - 不正な認証情報でのログイン試行
   - エラーメッセージの表示確認

## テスト実行方法

### ローカル環境での実行

```bash
# Cypressを開く
npm run cypress:open

# ヘッドレスモードで実行
npm run cypress:run
```

### GitHub Actions での実行

以下のタイミングで自動的にテストが実行されます：

1. main ブランチへのプッシュ時
2. develop ブランチへのプッシュ時
3. プルリクエスト作成時
4. 定期実行（6 時間ごと）

## テスト結果の確認

### 成功時

- GitHub Actions の実行結果が緑色で表示
- テスト動画とスクリーンショットがアーティファクトとして保存

### 失敗時

- GitHub Issue が自動作成
- 失敗したテストのスクリーンショットと動画が添付
- エラー内容の詳細が Issue に記載

## テスト成果物

テスト実行時に以下の成果物が生成されます：

1. スクリーンショット

   - 保存場所: `cypress/screenshots/`
   - 命名規則: `[テスト名]-[タイムスタンプ].png`

2. テスト実行動画
   - 保存場所: `cypress/videos/`
   - 形式: MP4
   - テストケースごとに個別の動画ファイル

## 注意事項

1. ローカルでテストを実行する場合：

   - バックエンドサーバーが起動していること
   - フロントエンドの開発サーバーが起動していること
   - 必要な環境変数が設定されていること

2. CI でのテスト実行時：
   - データベースの初期化が自動的に行われる
   - テスト用のデータが自動的に投入される
   - 環境変数は GitHub Secrets から自動設定
